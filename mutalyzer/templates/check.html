<html>
  <head>
    <link rel="stylesheet" 
      type="text/css" 
      href="base/css/style.css">
    <title></title>
  </head>
  <body>
    <div metal:define-macro="content">
      <center>
        <h3>Name checker</h3>
      </center>
      <div style="border: 1px solid grey; background-color: aliceblue; padding: 20px;">
        <div id = "output" tal:condition = "interactive">
          <div>
          Please insert the mutation name using the 
          <span class = "helper" 
          title = "Human Genome Variation Society standard variant nomenclature">
            <a href = "http://www.hgvs.org/mutnomen">HGVS</a> format</span>:<br>
            &lt;Accession Number&gt;.&lt;version 
            number&gt;(&lt;Gene symbol&gt;):&lt;sequence 
            type&gt;.&lt;mutation&gt;
          </div><br>
          Example: AB026906.1:c.274G&gt;T<br>
          <br>
          <form action = "" method = "post">
            <input 
              type = "text" 
              name = "mutationName" 
              tal:attributes = "value lastpost"
              style = "width:100%"
            ><br>
            <input type="submit" value="Submit">
            <input type="button" value="Clear field" 
                   onClick = "clearForm(this.form, 'mutationName');">  
          </form>
        </div>
        <div tal:condition = "visualisation">
          <b>Overview of the raw variants:</b><br>
          <div tal:repeat = "i visualisation">
            <br>
            <div tal:repeat = "j i">
              <div tal:condition = "repeat/j/start" 
                   tal:content = "structure string:Raw variant 
                                  ${repeat/i/number}: ${j}"></div>
              <tt tal:condition = "not: repeat/j/start" tal:content = "j">
              </tt>
            </div>
          </div>
        </div> <!-- not:visualisation -->
        <a tal:condition = "browserLink" tal:attributes = "href browserLink"><br>View region in UCSC Genome Browser</a>
      </div> <!-- form area -->
      <br>
      <div tal:condition = "lastpost">
        <h3>Name checker results:</h3>
        <div class="messages">
        <p tal:repeat = "m messages" tal:content = "m/description"
           tal:attributes = "class m/class; title string:${m/level} (origin: ${m/origin})"></p>
        <p tal:content = "summary"></p>
        </div>
        <br>
        <div tal:condition = "parseError">
          <h4>Details of the parse error:</h4>
          <pre tal:content = 
            "structure string:${parseError/0}<br>${parseError/1}">
          </pre>
          The &quot;^&quot; indicates the position where the error occurred.
          <br>
        </div> <!-- parseError -->
        <div tal:condition = "genomicDescription/0">
          <div tal:condition = "genomicDNA" tal:omit-tag="">
            <b>Genomic description:</b><br>
          </div> <!-- genomicDNA -->
          <div tal:condition = "not:genomicDNA" tal:omit-tag="">
            <b>Description relative to transcription start:</b><br>
            (Not for use in LSDBs in case of protein-coding transcripts).<br>
          </div> <!-- not:genomicDNA -->
          <br>
          <tt>
            <a tal:content = "genomicDescription/0"
               tal:attributes = "href 
                 string:checkForward?mutationName=${genomicDescription/1}">
            </a><br>
          </tt>
          <br>
          <br>
        </div> <!-- genomicDescription/0 -->
        <div tal:condition = "chromDescription">
          Alternative chromosomal position:<br>
          <br>
          <tt><div tal:replace = "chromDescription"></div><br></tt>
          <br>
          <br>
        </div> <!-- chromDescription -->
        <div tal:condition = "descriptions">
          <b>Affected transcripts:</b><br>
          <br>
          <tt tal:repeat = "i descriptions">
            <a tal:condition = "i/1" tal:content = "i/0"
               tal:attributes = 
                 "href string:checkForward?mutationName=${i/1}"></a><tal
               tal:condition = "not:i/1" tal:replace = "i/0"></tal><br> 
          </tt>
          <br>
          <br>
        </div> <!-- descriptions -->
        <div tal:condition = "protDescriptions">
          <b>Affected proteins:</b><br>
          <br>
          <tt>
            <div tal:repeat = "i protDescriptions"
                 tal:replace = "structure string:${i}<br>">
            </div>
          </tt>
          <br>
          <br>
        </div> <!-- protDescriptions -->
        <div tal:condition = "transcriptInfo">
          <b>Detailed information about the selected transcript:</b><br>
          <br>
          <div style = "background-color : aliceblue; padding : 20px; border: 1px solid grey">
            <div tal:condition = "oldProtein">
              <b>Reference protein:</b><br>
              <pre><div tal:repeat = "i oldProtein"
                        tal:replace = "structure string:${i}<br>">
                </div></pre>
              <br>
              <b>Protein predicted from variant coding sequence:</b><br>
              <div tal:condition = "not:newProtein">
                <br>
                No change: Predicted protein (not shown) equals reference
                protein. <br>
                <br>
              </div> <!-- not:newProtein -->
              <div tal:condition = "newProtein">
                <pre><div tal:repeat = "i newProtein"
                          tal:replace = "structure string:${i}<br>">
                  </div></pre>
              </div> <!-- newProtein -->
              <br>
              <div tal:condition = "altStart">
                <b tal:content = "structure string:Alternative protein 
                  using start codon ${altStart}:"></b><br>
                <div tal:condition = "altProtein">
                  <pre><div tal:repeat = "i altProtein"
                         tal:replace = "structure string:${i}<br>">
                    </div></pre>
                </div> <!-- altProtein -->
                <div tal:condition = "not:altProtein">
                  <br>
                  No change: Predicted protein (not shown) equals reference
                  protein. <br>
                  <br>
                </div> <!-- not:altProtein -->
                <br>
              </div> <!-- altStart -->
            </div> <!-- oldProtein -->
            <b>Exon information:</b><br>
            <table class = "raTable">
              <tr>
                <td>Number</td>
                <td>Start (g.)</td>
                <td>Stop (g.)</td>
                <td>
                  <span tal:condition="transcriptCoding" tal:omit-tag="">Start (c.)</span>
                  <span tal:condition="not:transcriptCoding" tal:omit-tag="">Start (n.)</span>
                </td>
                <td>
                  <span tal:condition="transcriptCoding" tal:omit-tag="">Stop (c.)</span>
                  <span tal:condition="not:transcriptCoding" tal:omit-tag="">Stop (n.)</span>
                </td>
              </tr>
              <tr tal:repeat = "i exonInfo">
                <td tal:content = "repeat/i/number"></td>
                <td tal:repeat = "j i" tal:content = "j"></td>
              </tr>
            </table>
            <div tal:condition="transcriptCoding" tal:omit-tag="">
              <br>
              <b><span class = "helper" title = "Coding Sequence">CDS</span> 
              information:</b><br>
              <table class = "raTable">
                <tr>
                  <td></td>
                  <td>g.</td>
                  <td>c.</td>
                </tr>
                <tr>
                  <td>Start</td>
                  <td tal:content = "cdsStart_g"></td>
                  <td tal:content = "cdsStart_c"></td>
                </tr>
                <tr>
                  <td>Stop</td>
                  <td tal:content = "cdsStop_g"></td>
                  <td tal:content = "cdsStop_c"></td>
                </tr>
                <tr>
                </tr>
              </table>
            </div>
          </div> <!-- background color -->
          <br>
          <br>
        </div>
        <div tal:condition = "restrictionSites">
          <b>Effects on Restriction sites:</b><br>
          <br>
          <table class = "laTable">
            <tr>
              <td>Raw variant</td>
              <td>Created</td>
              <td>Deleted</td>
            </tr>
            <tr tal:repeat = "i restrictionSites">
              <td tal:content = "repeat/i/number"></td>
              <td>
                <span tal:repeat = "j i/0">
                  <span tal:condition = "not:repeat/j/end"
                        tal:content = "structure string:${j},">
                  </span>
                  <span tal:condition = "repeat/j/end"
                        tal:content = "structure string:${j}">
                  </span>
                </span>
              </td>
              <td>
                <span tal:repeat = "j i/1">
                  <span tal:condition = "not:repeat/j/end"
                        tal:content = "structure string:${j},">
                  </span>
                  <span tal:condition = "repeat/j/end"
                        tal:content = "structure string:${j}">
                  </span>
                </span>
              </td>
            </tr>
          </table>
          <br>
          <br>
        </div> <!-- restrictionSites -->
        <div tal:condition = "legends">
          <b>Legend:</b><br>
          <br>
          <table class = "laTable">
            <tr>
              <td>Name</td>
              <td>ID</td>
              <td>Locus tag</td>
              <td>Product</td>
              <td>Link method</td>
            </tr>
            <tr tal:repeat = "i legends">
              <td tal:repeat = "j i" tal:content = "j"></td>
            </tr>
          </table>
          <br>
          <br>
        </div> <!-- legends -->
        <div tal:condition = "reference">
          <div tal:condition = "interactive">
            <b>Links:</b><br>
            <br>
            Download this reference sequence file: 
            <a tal:content = "reference"
               tal:attributes = "href string:Reference/${reference}"></a>
            <br>
            <br>
          </div> <!-- interactive -->
        </div> <!-- reference -->
      </div> <!-- lastpost -->
    </div>
  </body>
</html>
