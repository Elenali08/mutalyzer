Mutalyzer installation instructions.


Get Mutalyzer
=============

Since you are reading this, you can probably skip this step. Otherwise, get
your hands on a tarball and:

  $ tar -zxvf mutalyzer-XXX.tar.gz
  $ cd mutalyzer-XXX

Or get the source from SVN directly:

  $ svn https://www.mutalyzer.nl/svn/mutalyzer2/trunk mutalyzer
  $ cd mutalyzer


Install Dependencies
====================

If you are on Debian or Ubuntu, you can use the following command to install
all dependencies:

  $ sudo bash extras/pre-install-debian.sh

Otherwise, install them manually (perhaps have a look in the above script for
a useful dependency list). Also, further steps might assume some non-standard
locations for your distribution (so keep an eye on that).


Install Mutalyzer
=================

Mutalyzer can be installed using Python setuptools. For a production
environment:

  $ sudo python setup.py install

Alternatively, if you want to have a development environment, use:

  $ sudo python setup.py develop

The development environment uses symlinks to this source directory, so you can
develop directly from here.


Setup Mutalyzer
===============

This step creates configuration files and populates the database:

  $ sudo bash extras/post-install.sh


Test the Installation
=====================

Note: This step is broken at the moment. Some tests write to the cache for
      which we have no rights. This should be fixed to have a temporary cache
      for the tests I guess.

You should always test the installation. The tests (for now at least) need
the batch daemon and the webserver (the SOAP part) running:

  $ sudo /etc/init.d/mutalyzer-batchd start
  $ sudo /etc/init.d/apache2 restart

Now run the tests:

  $ MUTALYZER_ENV=test nosetests


Additional Notes
================

Included below for future reference is the old install.sh script. It is a bit
outdated.


#!/bin/sh

updateCron() {
  cron_entry="$1 python `pwd`/src/$2.py"

  if ! `crontab -l | grep "$cron_entry" > /dev/null`; then
    echo "Updating cron entry."
    if `crontab -l | grep $2 > /dev/null`; then
      echo "Removing old entry."
      crontab -l | grep -v $2 | crontab
    fi
    echo "Installing new entry."
    (
      crontab -l
      echo $cron_entry
    ) | crontab
  fi
}

if `echo $0 | grep '/' > /dev/null`; then
  echo "Please run this script from the installation directory."
  exit 1
fi

updateCron "25 6 \* \* \*" "UCSC_update"
updateCron "*/1 \* \* \* \*" "BatchChecker"

cat << EOF > .htaccess
SetHandler mod_python
PythonHandler src/handler
PythonPath "sys.path + ['`pwd`/src']"
PythonDebug On

RewriteEngine on
RewriteRule Variant_info.php Variant_info
RewriteRule .*bugtracker.* https://www.mutalyzer.nl/projects/mutalyzer2/
EOF

chmod go+rx . src src/Modules templates
chmod go+r .htaccess mutalyzer.conf src/*.py src/Modules/*.py templates/*
chmod go+rw var
